<html>
  <head>
    <script src="ease.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script>
      $(document).ready(function() {
        var ease = new Ease("dummy2", "test2", "DnhtXHzhMkqrZtmdjWeUeatBNzBLbJ");
        window.ease = ease;

        refreshMessages(ease);

        $("#chatform").submit(function(evt) {
          evt.preventDefault();
          console.log('hi')
          var inputText = $("#chatinput").val();
          $("#chatinput").val("");
          var messages = ease.read("/messages");
          if (messages == null) {
            messages = [];
          }
          messages.push(inputText);
          console.log(ease.save("/messages", messages));
          refreshMessages(ease);
          return false;
        })
      });

      function refreshMessages(ease) {
        var messageList = $("#messagelist");
        messageList.empty();
        var messages = ease.read("/messages");
        console.log("Messages: " + messages);
        if (messages == null || messages == "null") {
          return;
        }
        for (var i = 0; i < messages.length; i++) {
          messageList.append("<li>" + messages[i] + "</li>");
        }
      }
    </script>

  </head>
  <body>
    <h1>Chat Demo!</h1>
    <h2>Messages</h2>
    <ul id="messagelist">
    </ul>
    <form id="chatform">
      <input type="text" id="chatinput">
      <input type="submit" value="Send message!">
    </form>
  </body>
</html>
